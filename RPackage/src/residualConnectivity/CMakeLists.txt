cmake_minimum_required(VERSION 3.1)
set(CppFiles loadQt.cpp register.cpp crudeMC.cpp igraphInterface.cpp graphNELInterface.cpp graphAMInterface.cpp countConnectedSubgraphs.cpp stochasticEnumeration.cpp conditionalMC.cpp graphConvert.cpp graphInterface.cpp PMC.cpp createHexagonalLattice.cpp articulationConditioningResampling.cpp recursiveVarianceReduction.cpp gridCountSpecificSize.cpp gridCountSpecificSize2.cpp)
set(HeaderFiles loadQt.h crudeMC.h igraphInterface.h graphNELInterface.h graphAMInterface.h countConnectedSubgraphs.h stochasticEnumeration.h conditionalMC.h graphConvert.h graphInterface.h PMC.h createHexagonalLattice.h articulationConditioningResampling.h recursiveVarianceReduction.h gridCountSpecificSize.h)
add_library(residualConnectivityRPackage SHARED ${CppFiles} ${HeaderFiles})
target_link_libraries(residualConnectivityRPackage PUBLIC residualConnectivityCommon Rcpp monteCarloMethods exactMethods)
set_target_properties(residualConnectivityRPackage PROPERTIES OUTPUT_NAME "residualConnectivity")

if(BUILD_VISUALISATION)
	target_link_libraries(residualConnectivityRPackage PUBLIC Qt5::Core Qt5::Gui Qt5::Widgets ${IGRAPH_LIBRARIES})
	target_compile_definitions(residualConnectivityRPackage PUBLIC BUILD_VISUALISATION)
endif()
if(WIN32)
	target_compile_definitions(residualConnectivityRPackage PUBLIC _CRT_SECURE_NO_WARNINGS)
	target_link_libraries(residualConnectivityRPackage PRIVATE "${CMAKE_BINARY_DIR}/RPackage/R.lib")
	foreach(BUILD_TYPE IN LISTS CMAKE_CONFIGURATION_TYPES)
		string(TOUPPER "${BUILD_TYPE}" UPPER_BUILD_TYPE)
		set_target_properties(residualConnectivityRPackage PROPERTIES RUNTIME_OUTPUT_DIRECTORY_${UPPER_BUILD_TYPE} ${CMAKE_BINARY_DIR}/RPackage/${BUILD_TYPE}/inst/libs/x64 PDB_OUTPUT_DIRECTORY_${UPPER_BUILD_TYPE} ${CMAKE_BINARY_DIR}/RPackage/${BUILD_TYPE}/inst/libs/x64)
	endforeach()
else()
	set_target_properties(residualConnectivityRPackage PROPERTIES LIBRARY_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/RPackage/src)
	set_target_properties(residualConnectivityRPackage PROPERTIES PREFIX "")
endif()
