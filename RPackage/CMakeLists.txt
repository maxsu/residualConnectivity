project(residualConnectivity)
find_package(Rcpp REQUIRED)
add_custom_target(copyPackage ALL)

if(WIN32)
	foreach(BUILD_TYPE IN LISTS CMAKE_CONFIGURATION_TYPES)
		add_custom_command(TARGET copyPackage COMMAND ${CMAKE_COMMAND} -E copy_if_different NAMESPACE ${CMAKE_BINARY_DIR}/RPackage/${BUILD_TYPE})
		add_custom_command(TARGET copyPackage COMMAND ${CMAKE_COMMAND} -E copy_if_different DESCRIPTION ${CMAKE_BINARY_DIR}/RPackage/${BUILD_TYPE})
		if(EXISTS ${CMAKE_CURRENT_SOURCE_DIR}/data)
			add_custom_command(TARGET copyPackage POST_BUILD COMMAND ${CMAKE_COMMAND} ARGS -E copy_directory ${CMAKE_CURRENT_SOURCE_DIR}/data ${CMAKE_BINARY_DIR}/RPackage/${BUILD_TYPE}/data)
		endif()
	endforeach()
else()
	add_custom_command(TARGET copyPackage POST_BUILD COMMAND ${CMAKE_COMMAND} ARGS -E copy_if_different ${CMAKE_CURRENT_SOURCE_DIR}/NAMESPACE ${CMAKE_BINARY_DIR}/RPackage/NAMESPACE)
	add_custom_command(TARGET copyPackage POST_BUILD COMMAND ${CMAKE_COMMAND} ARGS -E copy_if_different ${CMAKE_CURRENT_SOURCE_DIR}/DESCRIPTION ${CMAKE_BINARY_DIR}/RPackage/DESCRIPTION)
	if(EXISTS ${CMAKE_CURRENT_SOURCE_DIR}/data)
		add_custom_command(TARGET copyPackage POST_BUILD COMMAND ${CMAKE_COMMAND} ARGS -E copy_directory ${CMAKE_CURRENT_SOURCE_DIR}/data ${CMAKE_BINARY_DIR}/RPackage/data)
	endif()
endif()

add_subdirectory(R)
add_subdirectory(src)
